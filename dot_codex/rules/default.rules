prefix_rule(pattern=["git", "push"], decision="prompt")
prefix_rule(pattern=["gh", "pr", "create"], decision="prompt")
prefix_rule(pattern=["docker"], decision="prompt")
prefix_rule(pattern=["ansible-playbook", "-K"], decision="prompt")
prefix_rule(pattern=["ansible-playbook", "--vault-id"], decision="prompt")

prefix_rule(pattern=["sudo"], decision="forbidden")
prefix_rule(pattern=["ssh"], decision="forbidden")
prefix_rule(pattern=["scp"], decision="forbidden")
prefix_rule(pattern=["rsync"], decision="forbidden")
prefix_rule(pattern=["curl"], decision="prompt")
prefix_rule(pattern=["wget"], decision="prompt")
prefix_rule(pattern=["rm", "-rf"], decision="forbidden")

prefix_rule(pattern=["git"], decision="allow")
prefix_rule(pattern=["gh"], decision="allow")
prefix_rule(pattern=["go"], decision="allow")
prefix_rule(pattern=["npm"], decision="allow")
prefix_rule(pattern=["npx"], decision="allow")
prefix_rule(pattern=["node"], decision="allow")
prefix_rule(pattern=["ls"], decision="allow")
prefix_rule(pattern=["cat"], decision="allow")
prefix_rule(pattern=["rg"], decision="allow")
prefix_rule(pattern=["find"], decision="allow")
prefix_rule(pattern=["sed"], decision="allow")
prefix_rule(pattern=["awk"], decision="allow")
prefix_rule(pattern=["ansible-lint"], decision="allow")
prefix_rule(pattern=["ansible-playbook"], decision="allow")
prefix_rule(pattern=["ln", "-sfn"], decision="allow")
prefix_rule(pattern=["mkdir", "-p"], decision="allow")

prefix_rule(pattern=["mkdir", "-p", ".agents/skills/grafana-panel-ops/agents"], decision="allow")
prefix_rule(pattern=["npx", "playwright", "install"], decision="allow")
prefix_rule(pattern=["npm", "run", "e2e"], decision="allow")
prefix_rule(pattern=["npx", "playwright", "test"], decision="allow")
prefix_rule(pattern=["rm", "-rf", "/tmp/mcp-grafana"], decision="allow")
